{"ast":null,"code":"import _regeneratorRuntime from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{addSong,removeSong,getFavoriteSongs}from'../services/favoriteSongsAPI';import'../styles/MusicCard.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MusicCard=/*#__PURE__*/function(_React$Component){_inherits(MusicCard,_React$Component);var _super=_createSuper(MusicCard);// É chamado dentro de <Album /> e <Favorites />.\nfunction MusicCard(){var _this;_classCallCheck(this,MusicCard);_this=_super.call(this);_this.recoverFavorites=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var favSongs;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Engloba, entre outras coisas, a função assíncrona getFavoriteSongs(). Essa última, recupera o array de objetos, referente às músicas favoritas, que estão salvas no local storage.\n_this.setState({loading:true});_context.next=3;return getFavoriteSongs();case 3:favSongs=_context.sent;_this.setState({loading:false,favoriteSongs:favSongs});case 5:case\"end\":return _context.stop();}}},_callee);}));_this.addRemoveFavorites=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2){var target,trackInfo;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:target=_ref2.target;// Engloba, entre outras coisas, as funções assíncronas addSong() e removeSong(). Essas últimas, marcam e desmarcam (respectivamente) uma determinada música como favorita, atualizando o local storage.\ntrackInfo=_this.props.trackInfo;_this.setState({loading:true});if(!target.checked){_context2.next=10;break;}_context2.next=6;return addSong(trackInfo);case 6:_context2.next=8;return _this.recoverFavorites();case 8:_context2.next=14;break;case 10:_context2.next=12;return removeSong(trackInfo);case 12:_context2.next=14;return _this.recoverFavorites();case 14:_this.setState({loading:false});case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.state={loading:false,favoriteSongs:[]};return _this;}_createClass(MusicCard,[{key:\"componentDidMount\",value:function componentDidMount(){this.recoverFavorites();}},{key:\"render\",value:function render(){var _this$props$trackInfo=this.props.trackInfo,trackName=_this$props$trackInfo.trackName,previewUrl=_this$props$trackInfo.previewUrl,trackId=_this$props$trackInfo.trackId;var _this$state=this.state,loading=_this$state.loading,favoriteSongs=_this$state.favoriteSongs;return/*#__PURE__*/_jsxs(\"div\",{className:\"eachTrack\",children:[/*#__PURE__*/_jsx(\"p\",{children:trackName}),/*#__PURE__*/_jsxs(\"audio\",{\"data-testid\":\"audio-component\",src:previewUrl,controls:true,children:[/*#__PURE__*/_jsx(\"track\",{kind:\"captions\"}),\"O seu navegador n\\xE3o suporta o elemento\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:trackId,children:[\"\\u2764\\uFE0F\",/*#__PURE__*/_jsx(\"input\",{id:trackId,\"data-testid\":\"checkbox-music-\".concat(trackId),type:\"checkbox\",name:trackId,onClick:this.addRemoveFavorites,checked:favoriteSongs.some(function(microObj){return microObj.trackId===trackId;})// Se a 'trackId' do momento for encontrada na lista de favoritas, o checkbox será marcado (true).\n})]}),loading&&/*#__PURE__*/_jsx(\"span\",{children:\"...\"})]});}}]);return MusicCard;}(React.Component);export default MusicCard;","map":{"version":3,"sources":["/home/joaofelipe/joaofelipelliccione_projetos-trybe/2-Frontend/trybe_frontend_4-trybetunes/src/components/MusicCard.jsx"],"names":["React","addSong","removeSong","getFavoriteSongs","MusicCard","recoverFavorites","setState","loading","favSongs","favoriteSongs","addRemoveFavorites","target","trackInfo","props","checked","state","trackName","previewUrl","trackId","some","microObj","Component"],"mappings":"mtCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,OAAT,CAAkBC,UAAlB,CAA8BC,gBAA9B,KAAsD,8BAAtD,CACA,MAAO,yBAAP,C,2FAEMC,CAAAA,S,kHAAoC;AACxC,oBAAc,2CACZ,wBADY,MAadC,gBAbc,sEAaK,gJAAc;AAC/B,MAAKC,QAAL,CAAc,CAAEC,OAAO,CAAE,IAAX,CAAd,EADiB,sBAGMJ,CAAAA,gBAAgB,EAHtB,QAGXK,QAHW,eAIjB,MAAKF,QAAL,CAAc,CACZC,OAAO,CAAE,KADG,CAEZE,aAAa,CAAED,QAFH,CAAd,EAJiB,sDAbL,SAuBdE,kBAvBc,2FAuBO,kKAASC,MAAT,OAASA,MAAT,CAAwB;AACnCC,SADW,CACG,MAAKC,KADR,CACXD,SADW,CAEnB,MAAKN,QAAL,CAAc,CAAEC,OAAO,CAAE,IAAX,CAAd,EAFmB,IAIfI,MAAM,CAACG,OAJQ,kDAKXb,CAAAA,OAAO,CAACW,SAAD,CALI,+BAMX,OAAKP,gBAAL,EANW,gEAQXH,CAAAA,UAAU,CAACU,SAAD,CARC,iCASX,OAAKP,gBAAL,EATW,SAanB,MAAKC,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAd,EAbmB,yDAvBP,gEAGZ,MAAKQ,KAAL,CAAa,CACXR,OAAO,CAAE,KADE,CAEXE,aAAa,CAAE,EAFJ,CAAb,CAHY,aAOb,C,uDAED,4BAAoB,CAClB,KAAKJ,gBAAL,GACD,C,sBA4BD,iBAAS,CACP,0BAA0D,KAAKQ,KAA/D,CAAQD,SAAR,CAAqBI,SAArB,uBAAqBA,SAArB,CAAgCC,UAAhC,uBAAgCA,UAAhC,CAA4CC,OAA5C,uBAA4CA,OAA5C,CACA,gBAAmC,KAAKH,KAAxC,CAAQR,OAAR,aAAQA,OAAR,CAAiBE,aAAjB,aAAiBA,aAAjB,CAEA,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,mBAAIO,SAAJ,EADF,cAEE,eAAO,cAAY,iBAAnB,CAAqC,GAAG,CAAGC,UAA3C,CAAwD,QAAQ,KAAhE,wBACE,cAAO,IAAI,CAAC,UAAZ,EADF,0DAGE,+BAHF,GAFF,cAOE,eAAO,OAAO,CAAGC,OAAjB,uCAEE,cACE,EAAE,CAAGA,OADP,CAEE,uCAAgCA,OAAhC,CAFF,CAGE,IAAI,CAAC,UAHP,CAIE,IAAI,CAAGA,OAJT,CAKE,OAAO,CAAG,KAAKR,kBALjB,CAME,OAAO,CAAGD,aAAa,CAACU,IAAd,CAAmB,SAACC,QAAD,QAAcA,CAAAA,QAAQ,CAACF,OAAT,GAAqBA,OAAnC,EAAnB,CAAiE;AAN7E,EAFF,GAPF,CAkBGX,OAAO,eAAI,6BAlBd,GADF,CAsBD,C,uBAlEqBP,KAAK,CAACqB,S,EA6E9B,cAAejB,CAAAA,SAAf","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { addSong, removeSong, getFavoriteSongs } from '../services/favoriteSongsAPI';\nimport '../styles/MusicCard.css';\n\nclass MusicCard extends React.Component { // É chamado dentro de <Album /> e <Favorites />.\n  constructor() {\n    super();\n\n    this.state = {\n      loading: false,\n      favoriteSongs: [],\n    };\n  }\n\n  componentDidMount() {\n    this.recoverFavorites();\n  }\n\n  recoverFavorites = async () => { // Engloba, entre outras coisas, a função assíncrona getFavoriteSongs(). Essa última, recupera o array de objetos, referente às músicas favoritas, que estão salvas no local storage.\n    this.setState({ loading: true });\n\n    const favSongs = await getFavoriteSongs();\n    this.setState({\n      loading: false,\n      favoriteSongs: favSongs,\n    });\n  }\n\n  addRemoveFavorites = async ({ target }) => { // Engloba, entre outras coisas, as funções assíncronas addSong() e removeSong(). Essas últimas, marcam e desmarcam (respectivamente) uma determinada música como favorita, atualizando o local storage.\n    const { trackInfo } = this.props;\n    this.setState({ loading: true });\n\n    if (target.checked) {\n      await addSong(trackInfo);\n      await this.recoverFavorites();\n    } else {\n      await removeSong(trackInfo);\n      await this.recoverFavorites();\n      // window.location.reload(false);\n    }\n\n    this.setState({ loading: false });\n  }\n\n  render() {\n    const { trackInfo: { trackName, previewUrl, trackId } } = this.props;\n    const { loading, favoriteSongs } = this.state;\n\n    return (\n      <div className=\"eachTrack\">\n        <p>{trackName}</p>\n        <audio data-testid=\"audio-component\" src={ previewUrl } controls>\n          <track kind=\"captions\" />\n          O seu navegador não suporta o elemento\n          <code>audio</code>\n        </audio>\n        <label htmlFor={ trackId }>\n          ❤️\n          <input\n            id={ trackId }\n            data-testid={ `checkbox-music-${trackId}` }\n            type=\"checkbox\"\n            name={ trackId }\n            onClick={ this.addRemoveFavorites }\n            checked={ favoriteSongs.some((microObj) => microObj.trackId === trackId) } // Se a 'trackId' do momento for encontrada na lista de favoritas, o checkbox será marcado (true).\n          />\n        </label>\n        {loading && <span>...</span>}\n      </div>\n    );\n  }\n}\n\nMusicCard.propTypes = {\n  trackInfo: PropTypes.shape({\n    trackName: PropTypes.string,\n    previewUrl: PropTypes.string,\n    trackId: PropTypes.number,\n  }).isRequired,\n};\n\nexport default MusicCard;\n"]},"metadata":{},"sourceType":"module"}